---
title: Dashboard Flow
description: Protected user interface and management with role-based access control
Last updated at: 2025-10-21
---

## Overview

Provides protected user interface for authenticated users with role-based access control. Includes main dashboard, billing management, settings, and admin panel with different features based on user roles.

**Main libraries/services:**

- Next.js App Router for page routing
- Role-based access control (USER/ADMIN)
- Server-side session validation
- Protected route middleware

## File Map

```
ğŸ“ app/(protected)/layout.tsx - Protected route wrapper
ğŸ“ app/(protected)/dashboard/page.tsx - Main dashboard
ğŸ“ app/(protected)/dashboard/billing/page.tsx - Billing management
ğŸ“ app/(protected)/dashboard/settings/page.tsx - User settings
ğŸ“ app/(protected)/dashboard/charts/page.tsx - Chart examples
ğŸ“ app/(protected)/admin/page.tsx - Admin panel
ğŸ“ app/(protected)/admin/orders/page.tsx - Order management
ğŸ“ components/dashboard/ - Dashboard-specific components
ğŸ“ lib/session.ts - Session management utilities
```

## Step-by-Step Flow

### Dashboard Access

1. User navigates to protected route
2. `(protected)/layout.tsx` checks authentication
3. `getCurrentUser()` validates session
4. If unauthenticated, redirect to `/login`
5. If authenticated, render dashboard content
6. User role determines available features

### Main Dashboard

1. Dashboard page loads with user data
2. User role displayed in header
3. Empty placeholder shown (no content created yet)
4. "Add Content" button for future functionality
5. Role-based navigation menu available

### Billing Dashboard

1. User subscription plan fetched via `getUserSubscriptionPlan`
2. Billing information displayed with current plan
3. Upgrade/downgrade options based on current tier
4. Stripe test environment warning shown
5. Billing portal access for existing customers

### Settings Management

1. User profile information displayed
2. Name and role update forms available
3. Account deletion option (with confirmation)
4. Settings persisted via server actions

### Admin Panel (ADMIN role only)

1. Role validation ensures ADMIN access only
2. Admin-specific dashboard with metrics
3. User management capabilities
4. Transaction and order management
5. System-wide analytics and controls

### Charts Dashboard

1. Demo charts using shadcn-ui components
2. Various chart types (area, bar, line, radial)
3. Interactive data visualization examples
4. Responsive grid layout for different screen sizes

## Data Flow Diagram

```
[Protected Route] â†’ [Session Validation] â†’ [Role Check] â†’ [Dashboard Render]
     â†“
[User Actions] â†’ [Server Actions] â†’ [Database Updates] â†’ [UI Refresh]
     â†“
[Admin Actions] â†’ [Admin Panel] â†’ [System Management] â†’ [User Updates]
```

## Role-Based Features

### USER Role

- Main dashboard access
- Billing management
- Personal settings
- Chart examples
- Content creation (placeholder)

### ADMIN Role

- All USER features
- Admin panel access
- User management
- System analytics
- Order management
- Transaction oversight

## Protected Route Structure

```
(protected)/
â”œâ”€â”€ layout.tsx (authentication wrapper)
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ page.tsx (main dashboard)
â”‚   â”œâ”€â”€ billing/page.tsx (subscription management)
â”‚   â”œâ”€â”€ settings/page.tsx (user preferences)
â”‚   â””â”€â”€ charts/page.tsx (demo charts)
â””â”€â”€ admin/
    â”œâ”€â”€ layout.tsx (admin role check)
    â”œâ”€â”€ page.tsx (admin dashboard)
    â””â”€â”€ orders/page.tsx (order management)
```

## Notes and TODOs

- âœ… Role-based access control implemented
- âœ… Protected route middleware working
- âœ… Billing integration with subscription data
- âœ… Admin panel with restricted access
- âœ… Responsive dashboard layout
- âœ… Chart examples for data visualization
- âš ï¸ Main dashboard shows empty placeholder
- ğŸ”„ Implement actual content creation features
- ğŸ”„ Add user activity tracking
- ğŸ”„ Implement admin user management
- ğŸ”„ Add dashboard analytics and metrics
- ğŸ”„ Create user onboarding flow
- ğŸ”„ Add notification system
